<UserControl x:Class="OOP_Semester.Views.HabitView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:conv="clr-namespace:OOP_Semester.Converters"
             mc:Ignorable="d"
             d:DesignHeight="850" d:DesignWidth="1100"
             FontFamily="Segoe UI">

    <UserControl.Resources>
        <SolidColorBrush x:Key="Primary" Color="#F97316"/>
        <SolidColorBrush x:Key="TextDark" Color="#1F2937"/>
        <SolidColorBrush x:Key="TextMuted" Color="#6B7280"/>
        <SolidColorBrush x:Key="BorderBrushSoft" Color="#E5E7EB"/>
        <SolidColorBrush x:Key="BgLight" Color="#F9FAFB"/>

        <DropShadowEffect x:Key="CardShadow" BlurRadius="20" ShadowDepth="4" Opacity="0.05" Direction="270"/>
        <BooleanToVisibilityConverter x:Key="BoolToVis"/>

        <Style x:Key="ModernInputStyle" TargetType="TextBox">
            <Setter Property="Background" Value="White"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="{StaticResource BorderBrushSoft}"/>
            <Setter Property="Padding" Value="12,10"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TextBox">
                        <Border x:Name="bd" Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="12">
                            <ScrollViewer x:Name="PART_ContentHost" Margin="0"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsKeyboardFocused" Value="True">
                                <Setter TargetName="bd" Property="BorderBrush" Value="{StaticResource Primary}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="RoundedButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="{StaticResource Primary}"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Padding" Value="15,8"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="bd" Background="{TemplateBinding Background}" CornerRadius="12">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="bd" Property="Opacity" Value="0.9"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="bd" Property="Opacity" Value="0.8"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="BigCircleToggle" TargetType="ToggleButton">
            <Setter Property="Width" Value="45"/>
            <Setter Property="Height" Value="45"/>
            <Setter Property="Margin" Value="4"/>
            <Setter Property="Background" Value="White"/>
            <Setter Property="BorderBrush" Value="{StaticResource BorderBrushSoft}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ToggleButton">
                        <Border x:Name="bd" CornerRadius="22.5" 
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" TextBlock.FontWeight="Bold"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="bd" Property="Background" Value="{StaticResource Primary}"/>
                                <Setter TargetName="bd" Property="BorderThickness" Value="0"/>
                                <Setter Property="Foreground" Value="White"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="SessionToggle" TargetType="ToggleButton">
            <Setter Property="Height" Value="36"/>
            <Setter Property="Background" Value="White"/>
            <Setter Property="BorderBrush" Value="{StaticResource BorderBrushSoft}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Margin" Value="0,0,8,0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ToggleButton">
                        <Border x:Name="bd" CornerRadius="10" Background="{TemplateBinding Background}" 
                                BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Padding="12,0">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" TextBlock.FontWeight="SemiBold"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="bd" Property="Background" Value="{StaticResource Primary}"/>
                                <Setter TargetName="bd" Property="BorderThickness" Value="0"/>
                                <Setter Property="Foreground" Value="White"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="ToggleSwitchStyle" TargetType="ToggleButton">
            <Setter Property="Width" Value="50"/>
            <Setter Property="Height" Value="26"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ToggleButton">
                        <Grid>
                            <Border x:Name="Track" Background="#E5E7EB" CornerRadius="13"/>
                            <Ellipse x:Name="Thumb" Width="22" Height="22" Fill="White" HorizontalAlignment="Left" Margin="2">
                                <Ellipse.Effect>
                                    <DropShadowEffect ShadowDepth="1" BlurRadius="2" Opacity="0.2"/>
                                </Ellipse.Effect>
                            </Ellipse>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="Track" Property="Background" Value="{StaticResource Primary}"/>
                                <Setter TargetName="Thumb" Property="HorizontalAlignment" Value="Right"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="PillRadioButton" TargetType="RadioButton">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="RadioButton">
                        <Border x:Name="bd" Background="Transparent" BorderBrush="{StaticResource BorderBrushSoft}" 
                                BorderThickness="1" CornerRadius="12" Padding="15,10" Margin="0,0,10,0" Cursor="Hand">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" TextBlock.FontWeight="SemiBold"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="bd" Property="Background" Value="{StaticResource Primary}"/>
                                <Setter TargetName="bd" Property="BorderThickness" Value="0"/>
                                <Setter Property="Foreground" Value="White"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="CircleBtn" TargetType="Button">
            <Setter Property="Width" Value="32"/>
            <Setter Property="Height" Value="32"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="bd" Background="{TemplateBinding Background}" CornerRadius="999">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="bd" Property="Background" Value="#10000000"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style TargetType="DatePicker">
            <Setter Property="Foreground" Value="{StaticResource TextDark}"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="DatePicker">
                        <Border Background="White" BorderBrush="{StaticResource BorderBrushSoft}" BorderThickness="1" CornerRadius="12" Padding="2">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <DatePickerTextBox x:Name="PART_TextBox" Grid.Column="0" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Background="Transparent" BorderThickness="0" FontSize="14"/>
                                <Button x:Name="PART_Button" Grid.Column="1" Width="30" Background="Transparent" BorderThickness="0" Foreground="{StaticResource Primary}" Focusable="False">
                                    <TextBlock Text="📅" FontSize="16" VerticalAlignment="Center"/>
                                </Button>
                                <Popup x:Name="PART_Popup"/>
                            </Grid>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </UserControl.Resources>

    <Grid Background="Transparent">
        <Border MaxWidth="1000" HorizontalAlignment="Center" VerticalAlignment="Top"
                Margin="0" CornerRadius="18" Background="White"
                Effect="{StaticResource CardShadow}">

            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="320"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <Border Grid.Column="0" Background="#FFFBF7" CornerRadius="18,0,0,18" Padding="20">
                    <StackPanel>
                        <TextBlock Text="Người bạn đồng hành" FontSize="16" FontWeight="Bold" HorizontalAlignment="Center"/>
                        <Grid Height="200" Margin="0,20">
                            <Ellipse Width="180" Height="180" Fill="White"/>
                            <Image Source="{Binding CurrentPetImage}" Height="140"/>
                        </Grid>

                        <Border Background="White" CornerRadius="12" Padding="15">
                            <StackPanel>
                                <TextBlock Text="{Binding PetLevel, StringFormat='Cấp độ {0}'}" FontWeight="Bold"/>
                                <ProgressBar Value="{Binding PetXp}" Maximum="{Binding PetXpMax}" Height="8" Margin="0,10" Background="#F3F4F6" Foreground="{StaticResource Primary}" BorderThickness="0"/>
                                <TextBlock Text="💡 Mẹo: Tạo thói quen khó để nhận nhiều XP hơn!" FontSize="11" Foreground="{StaticResource TextMuted}" TextWrapping="Wrap"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </Border>

                <Grid Grid.Column="1">
                    <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="30">
                        <StackPanel>
                            <Grid Margin="0,0,0,20">
                                <TextBlock Text="Thêm Thói quen Mới" FontSize="22" FontWeight="Bold"/>
                                <Button HorizontalAlignment="Right" Content="✕" Style="{StaticResource CircleBtn}" Command="{Binding CancelCommand}" Foreground="{StaticResource TextMuted}" FontSize="16"/>
                            </Grid>

                            <TextBlock Text="Tên thói quen" FontWeight="SemiBold" Margin="0,0,0,6"/>
                            <TextBox Style="{StaticResource ModernInputStyle}" Text="{Binding HabitName}" Tag="VD: Chạy bộ..."/>

                            <Grid Margin="0,20,0,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <StackPanel Margin="0,0,10,0">
                                    <TextBlock Text="Biểu tượng" FontWeight="SemiBold" Margin="0,0,0,6"/>
                                    <Border BorderBrush="{StaticResource BorderBrushSoft}" BorderThickness="1" CornerRadius="12" Padding="5">
                                        <ListBox ItemsSource="{Binding IconList}" SelectedValue="{Binding SelectedIcon}" 
                                                 ScrollViewer.HorizontalScrollBarVisibility="Disabled" BorderThickness="0" Background="Transparent" Height="81" Width="186">
                                            <ListBox.ItemsPanel>
                                                <ItemsPanelTemplate>
                                                    <WrapPanel />
                                                </ItemsPanelTemplate>
                                            </ListBox.ItemsPanel>
                                            <ListBox.ItemTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding}" FontSize="24" Margin="5"/>
                                                </DataTemplate>
                                            </ListBox.ItemTemplate>
                                        </ListBox>
                                    </Border>
                                </StackPanel>

                                <StackPanel Grid.Column="1" Margin="10,0,0,0">
                                    <TextBlock Text="Màu sắc" FontWeight="SemiBold" Margin="0,0,0,6"/>

                                    <Border BorderBrush="{StaticResource BorderBrushSoft}" BorderThickness="1" CornerRadius="12" Padding="8" Height="93">
                                        <ListBox ItemsSource="{Binding AvailableColors}" 
                 SelectedValue="{Binding SelectedColorHex}"
                 BorderThickness="0" Background="Transparent"
                 ScrollViewer.HorizontalScrollBarVisibility="Disabled">

                                            <ListBox.ItemsPanel>
                                                <ItemsPanelTemplate>
                                                    <WrapPanel Orientation="Horizontal" Width="180"/>
                                                </ItemsPanelTemplate>
                                            </ListBox.ItemsPanel>

                                            <ListBox.ItemContainerStyle>
                                                <Style TargetType="ListBoxItem">
                                                    <Setter Property="Cursor" Value="Hand"/>
                                                    <Setter Property="Margin" Value="4"/>
                                                    <Setter Property="Padding" Value="0"/>
                                                    <Setter Property="Template">
                                                        <Setter.Value>
                                                            <ControlTemplate TargetType="ListBoxItem">
                                                                <Grid>
                                                                    <Ellipse x:Name="SelectionRing" Width="38" Height="38" 
                                             Stroke="#9CA3AF" StrokeThickness="2" 
                                             Visibility="Collapsed"/>

                                                                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                                </Grid>

                                                                <ControlTemplate.Triggers>
                                                                    <Trigger Property="IsSelected" Value="True">
                                                                        <Setter TargetName="SelectionRing" Property="Visibility" Value="Visible"/>
                                                                    </Trigger>
                                                                    <Trigger Property="IsMouseOver" Value="True">
                                                                        <Setter TargetName="SelectionRing" Property="Visibility" Value="Visible"/>
                                                                        <Setter TargetName="SelectionRing" Property="Opacity" Value="0.5"/>
                                                                    </Trigger>
                                                                </ControlTemplate.Triggers>
                                                            </ControlTemplate>
                                                        </Setter.Value>
                                                    </Setter>
                                                </Style>
                                            </ListBox.ItemContainerStyle>

                                            <ListBox.ItemTemplate>
                                                <DataTemplate>
                                                    <Border Width="30" Height="30" CornerRadius="15" Background="{Binding}">
                                                        <Border.Effect>
                                                            <DropShadowEffect ShadowDepth="1" BlurRadius="2" Opacity="0.2"/>
                                                        </Border.Effect>
                                                    </Border>
                                                </DataTemplate>
                                            </ListBox.ItemTemplate>
                                        </ListBox>
                                    </Border>
                                </StackPanel>
                            </Grid>

                            <TextBlock Text="Loại mục tiêu" FontWeight="SemiBold" Margin="0,20,0,10"/>
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,15">
                                <RadioButton Content="Mỗi ngày" GroupName="GoalType" IsChecked="{Binding IsDailyGoal}" Style="{StaticResource PillRadioButton}"/>
                                <RadioButton Content="Tổng cộng" GroupName="GoalType" IsChecked="{Binding IsTotalGoal}" Style="{StaticResource PillRadioButton}"/>
                            </StackPanel>

                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <StackPanel Grid.Column="0" Margin="0,0,10,0">
                                    <TextBlock Text="Số lượng" FontWeight="SemiBold" Margin="0,0,0,6"/>
                                    <TextBox Style="{StaticResource ModernInputStyle}" Text="{Binding DailyGoalValue}" Tag="Lần/ngày" Visibility="{Binding IsDailyGoal, Converter={StaticResource BoolToVis}}"/>
                                    <TextBox Style="{StaticResource ModernInputStyle}" Text="{Binding TotalGoalValue}" Tag="Tổng số lượng" Visibility="{Binding IsTotalGoal, Converter={StaticResource BoolToVis}}"/>
                                </StackPanel>
                                <StackPanel Grid.Column="1" Margin="10,0,0,0">
                                    <TextBlock Text="Đơn vị" FontWeight="SemiBold" Margin="0,0,0,6"/>
                                    <TextBox Style="{StaticResource ModernInputStyle}" Text="{Binding Unit}" Tag="Lần, KM..."/>
                                </StackPanel>
                            </Grid>

                            <StackPanel Margin="0,25,0,0">
                                <Grid Margin="0,0,0,10">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="Lặp lại mỗi ngày" FontWeight="Bold" VerticalAlignment="Center"/>
                                    </StackPanel>
                                    <ToggleButton HorizontalAlignment="Right" IsChecked="{Binding IsEveryday}" Style="{StaticResource ToggleSwitchStyle}"/>
                                </Grid>
                                <StackPanel IsEnabled="{Binding IsEveryday, Converter={StaticResource BoolToVis}, ConverterParameter=Inverse}">
                                    <UniformGrid Columns="7">
                                        <ToggleButton Content="T2" IsChecked="{Binding Mon}" Style="{StaticResource BigCircleToggle}"/>
                                        <ToggleButton Content="T3" IsChecked="{Binding Tue}" Style="{StaticResource BigCircleToggle}"/>
                                        <ToggleButton Content="T4" IsChecked="{Binding Wed}" Style="{StaticResource BigCircleToggle}"/>
                                        <ToggleButton Content="T5" IsChecked="{Binding Thu}" Style="{StaticResource BigCircleToggle}"/>
                                        <ToggleButton Content="T6" IsChecked="{Binding Fri}" Style="{StaticResource BigCircleToggle}"/>
                                        <ToggleButton Content="T7" IsChecked="{Binding Sat}" Style="{StaticResource BigCircleToggle}"/>
                                        <ToggleButton Content="CN" IsChecked="{Binding Sun}" Style="{StaticResource BigCircleToggle}"/>
                                    </UniformGrid>
                                </StackPanel>
                            </StackPanel>

                            <Grid Margin="0,20,0,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <StackPanel Margin="0,0,10,0">
                                    <TextBlock Text="Bắt đầu" FontWeight="SemiBold" Margin="0,0,0,6"/>
                                    <DatePicker SelectedDate="{Binding StartDate}" Height="42"/>
                                </StackPanel>
                                <StackPanel Grid.Column="1" Margin="10,0,0,0">
                                    <TextBlock Text="Kết thúc" FontWeight="SemiBold" Margin="0,0,0,6"/>
                                    <DatePicker SelectedDate="{Binding EndDate}" Height="42"/>
                                </StackPanel>
                            </Grid>

                            <StackPanel Margin="0,25,0,0">
                                <TextBlock Text="Cài đặt Nhắc nhở" FontWeight="SemiBold" Margin="0,0,0,10"/>

                                <StackPanel Orientation="Horizontal" Margin="0,0,0,15">
                                    <RadioButton Content="Theo buổi" GroupName="ReminderType" IsChecked="{Binding IsReminderBySession}" Style="{StaticResource PillRadioButton}"/>
                                    <RadioButton Content="Giờ cố định" GroupName="ReminderType" IsChecked="{Binding IsReminderByTime}" Style="{StaticResource PillRadioButton}"/>
                                </StackPanel>

                                <StackPanel Visibility="{Binding IsReminderBySession, Converter={StaticResource BoolToVis}}">
                                    <StackPanel Orientation="Horizontal">
                                        <ToggleButton Content="{Binding MorningLabel}" IsChecked="{Binding RemindMorning}" Style="{StaticResource SessionToggle}"/>
                                        <ToggleButton Content="{Binding AfternoonLabel}" IsChecked="{Binding RemindAfternoon}" Style="{StaticResource SessionToggle}"/>
                                        <ToggleButton Content="{Binding EveningLabel}" IsChecked="{Binding RemindEvening}" Style="{StaticResource SessionToggle}"/>
                                    </StackPanel>
                                </StackPanel>

                                <StackPanel Visibility="{Binding IsReminderByTime, Converter={StaticResource BoolToVis}}">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBox Style="{StaticResource ModernInputStyle}" Text="{Binding ReminderInput}" Tag="VD: 06:30"/>
                                        <Button Grid.Column="1" Content="Thêm" Margin="10,0,0,0" 
                                                Command="{Binding AddReminderCommand}"
                                                Style="{StaticResource RoundedButtonStyle}"/>
                                    </Grid>
                                    <ItemsControl ItemsSource="{Binding ReminderTimes}" Margin="0,10,0,0">
                                        <ItemsControl.ItemsPanel>
                                            <ItemsPanelTemplate>
                                                <WrapPanel/>
                                            </ItemsPanelTemplate>
                                        </ItemsControl.ItemsPanel>
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>
                                                <Border Background="#F3F4F6" CornerRadius="15" Padding="10,5" Margin="0,0,5,5">
                                                    <StackPanel Orientation="Horizontal">
                                                        <TextBlock Text="{Binding}" FontWeight="SemiBold" Foreground="{StaticResource TextDark}"/>
                                                        <Button Content="✕" Margin="8,0,0,0" Background="Transparent" BorderThickness="0" Foreground="{StaticResource TextMuted}"
                                                                Command="{Binding DataContext.RemoveReminderCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" 
                                                                CommandParameter="{Binding}" Cursor="Hand"/>
                                                    </StackPanel>
                                                </Border>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>
                                </StackPanel>
                            </StackPanel>

                            <Grid Margin="0,30,0,0">
                                <Button Content="Hủy bỏ" HorizontalAlignment="Left" Background="Transparent" Foreground="{StaticResource TextMuted}" BorderThickness="0" Command="{Binding CancelCommand}"/>
                                <Button Content="Lưu Thói Quen" HorizontalAlignment="Right" Width="150" Height="45"
                                        Command="{Binding SaveCommand}"
                                        Style="{StaticResource RoundedButtonStyle}"/>
                            </Grid>

                        </StackPanel>
                    </ScrollViewer>
                </Grid>
            </Grid>
        </Border>
    </Grid>
</UserControl>